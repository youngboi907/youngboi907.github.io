<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Binance Real-Time Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; background: #111; color: #eee; }
    h2 { color: #0f0; }
    .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; padding: 20px; }
    .box { background: #222; padding: 15px; border-radius: 10px; }
    canvas { background: #000; border: 1px solid #444; }
  </style>
</head>
<body>
  <h1 style="text-align:center">Binance Real-Time Market Dashboard (Spot & Futures)</h1>
  <h2 style="text-align:center">Spot BTCUSDT</h2>
  <div class="grid">
    <div class="box"><h2>Taker Delta</h2><p id="spot-delta">Loading...</p></div>
    <div class="box"><h2>CVD</h2><p id="spot-cvd">0</p></div>
    <div class="box"><h2>VWAP</h2><p id="spot-vwap">0</p></div>
    <div class="box"><h2>Aggression Speed</h2><p id="spot-speed">0</p></div>
    <div class="box"><h2>Order Book Imbalance</h2><p id="spot-imbalance">Loading...</p></div>
    <div class="box"><h2>Trade Size Distribution</h2><canvas id="spot-histogram" width="300" height="150"></canvas></div>
  </div>  <h2 style="text-align:center">Futures BTCUSDT</h2>
  <div class="grid">
    <div class="box"><h2>Taker Delta</h2><p id="fut-delta">Loading...</p></div>
    <div class="box"><h2>CVD</h2><p id="fut-cvd">0</p></div>
    <div class="box"><h2>VWAP</h2><p id="fut-vwap">0</p></div>
    <div class="box"><h2>Aggression Speed</h2><p id="fut-speed">0</p></div>
    <div class="box"><h2>Order Book Imbalance</h2><p id="fut-imbalance">Loading...</p></div>
    <div class="box"><h2>Trade Size Distribution</h2><canvas id="fut-histogram" width="300" height="150"></canvas></div>
  </div>  <script>
    function setupBinanceStream(wsUrl, prefix) {
      const deltaEl = document.getElementById(`${prefix}-delta`);
      const cvdEl = document.getElementById(`${prefix}-cvd`);
      const vwapEl = document.getElementById(`${prefix}-vwap`);
      const speedEl = document.getElementById(`${prefix}-speed`);
      const imbalanceEl = document.getElementById(`${prefix}-imbalance`);
      const canvas = document.getElementById(`${prefix}-histogram`);
      const ctx = canvas.getContext("2d");

      let delta = 0, cvd = 0, speed = 0, totalVolume = 0, totalValue = 0;
      let tradeCount = 0, tradeBins = Array(10).fill(0);

      const ws = new WebSocket(wsUrl);
      ws.onmessage = (event) => {
        const data = JSON.parse(event.data);
        if (data.stream.includes("aggTrade")) {
          const trade = data.data;
          const vol = parseFloat(trade.q);
          const price = parseFloat(trade.p);
          const side = trade.m ? -1 : 1;

          delta += vol * side;
          cvd += vol * side;
          totalVolume += vol;
          totalValue += vol * price;
          tradeCount++;

          const bin = Math.min(Math.floor(vol), 9);
          tradeBins[bin]++;

          deltaEl.innerText = delta.toFixed(3);
          cvdEl.innerText = cvd.toFixed(3);
          vwapEl.innerText = (totalValue / totalVolume).toFixed(2);
        }
        if (data.stream.includes("depth")) {
          const bids = data.data.bids.map(b => parseFloat(b[1])).reduce((a,b) => a + b, 0);
          const asks = data.data.asks.map(a => parseFloat(a[1])).reduce((a,b) => a + b, 0);
          const imbalance = ((bids - asks) / (bids + asks)) * 100;
          imbalanceEl.innerText = `${imbalance.toFixed(2)}% (Bids vs Asks)`;
        }
      };

      setInterval(() => {
        speedEl.innerText = `${tradeCount} trades/sec`;
        tradeCount = 0;
      }, 1000);

      setInterval(() => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const max = Math.max(...tradeBins);
        tradeBins.forEach((count, i) => {
          const height = (count / max) * canvas.height;
          ctx.fillStyle = "lime";
          ctx.fillRect(i * 30, canvas.height - height, 20, height);
        });
      }, 1000);
    }

    setupBinanceStream("wss://stream.binance.com:9443/stream?streams=btcusdt@aggTrade/btcusdt@depth10@100ms", "spot");
    setupBinanceStream("wss://fstream.binance.com/stream?streams=btcusdt@aggTrade/btcusdt@depth10@100ms", "fut");
  </script></body>
</html>